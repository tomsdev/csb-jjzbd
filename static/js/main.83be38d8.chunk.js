(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{27:function(e,t,n){e.exports=n(28)},28:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(6),o=n(9),s=n(2),l=n(5),u=n.n(l),i=n(21),m=n.n(i),p=n(22),b=n.n(p),f=n(23),d=n(17),v=n.n(d),g=n(25),h=(n(43),new f.a);function j(e,t){return e.data.reduce(function(e,n){var a=t.map(function(e){return n[e]}).join("");return e.set(a,n),e},new Map)}function O(){return(O=Object(s.a)(r.a.mark(function e(t,n,a,s,l,u){var i,m,p,b,f,d,j,O;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.log(a),u(!0),i=v()(),m=s,p=Object(c.a)(t),e.prev=5,p.s();case 7:if((b=p.n()).done){e.next=20;break}return f=Object(o.a)(b.value,2),f[0],d=f[1],e.next=11,h.process(a,d);case 11:if(j=e.sent,O=n.map(function(e){return d[e]}).join("_"),i.file("".concat(O,".docx"),j,{binary:!0}),l(--m),!(m<=0)){e.next=18;break}return e.abrupt("break",20);case 18:e.next=7;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(5),p.e(e.t0);case 25:return e.prev=25,p.f(),e.finish(25);case 28:i.generateAsync({type:"blob"}).then(function(e){Object(g.saveAs)(e,"".concat(a.name.split(".")[0],"_documents.zip")),u(!1),l(t.size)});case 29:case"end":return e.stop()}},e,null,[[5,22,25,28]])}))).apply(this,arguments)}function E(){var e=Object(l.useState)(null),t=Object(o.a)(e,2),n=t[0],a=t[1];return[n,function(e){return b.a.parse(e,{header:!0,complete:a})}]}function x(){var e=E(),t=Object(o.a)(e,2),n=t[0],a=t[1],r=E(),c=Object(o.a)(r,2),s=c[0],i=c[1],m=Object(l.useState)(),p=Object(o.a)(m,2),b=p[0],f=p[1],d=Object(l.useState)(),v=Object(o.a)(d,2),g=v[0],h=v[1],x=Object(l.useState)(),y=Object(o.a)(x,2),w=y[0],k=y[1],C=Object(l.useState)(0),F=Object(o.a)(C,2),S=F[0],N=F[1],q=Object(l.useState)(!1),z=Object(o.a)(q,2),A=z[0],J=z[1];return Object(l.useEffect)(function(){if(n&&s&&g){var e=j(n,g),t=j(s,g),a=new Map;e.forEach(function(e,n){var r=t.get(n);a.set(n,Object.assign({},e,r))}),console.log("merged csv files:"),console.log(a),f(a),N(a.size)}},[n,s,g,N]),u.a.createElement("div",{className:"App"},u.a.createElement("form",{method:"get",action:"#"},u.a.createElement("fieldset",null,u.a.createElement("label",{htmlFor:"csv"},"Fichier tableau au format CSV qui contient une ligne par document a generer"),u.a.createElement("input",{name:"csv",type:"file",accept:"text/csv, .csv",onChange:function(e){return a(e.target.files[0])}}),u.a.createElement("label",{htmlFor:"csv2"},"Fichier tableau au format CSV qui contient des colonnes supplementaires"),u.a.createElement("input",{name:"csv2",type:"file",accept:"text/csv, .csv",onChange:function(e){return i(e.target.files[0])}}),u.a.createElement("label",{htmlFor:"colonnes"},"Noms des colonnes qui sont les meme dans les classeurs (separer par des virgules, exemple: Noms,Prenoms)"),u.a.createElement("input",{name:"colonnes",type:"text",onChange:function(e){return h(e.target.value.split(","))}}),u.a.createElement("label",{htmlFor:"modele"},"Fichier de modele Word format .docx pour generer les documents"),u.a.createElement("input",{name:"modele",type:"file",accept:"application/msword, .docx, .doc",onChange:function(e){return k(e.target.files[0])}}),u.a.createElement("label",{htmlFor:"modele"},"Nombres de documents a generer"),u.a.createElement("input",{name:"count",type:"number",min:"1",max:"10000",onChange:function(e){return N(e.target.value)}}),u.a.createElement("br",null),u.a.createElement("button",{type:"submit",disabled:A,style:{backgroundColor:A?"red":"green"},onClick:function(){return function(e,t,n,a,r,c){return O.apply(this,arguments)}(b,g,w,S,N,J)}},"Generer ",S," documents"))))}var y=document.getElementById("root");m.a.render(u.a.createElement(x,null),y)},43:function(e,t,n){}},[[27,1,2]]]);
//# sourceMappingURL=main.83be38d8.chunk.js.map